{% extends "base.html" %}

{% block content %}
<div class="toolbar" style="display:flex; justify-content:space-between; align-items:center; gap:12px;">
  <div style="display:flex; gap:10px;">
    <a class="btn-secondary {% if tab == 'people' %}btn-active{% endif %}" href="{% url 'staff_people' %}">Персонал</a>
    <a class="btn-secondary {% if tab == 'roles' %}btn-active{% endif %}" href="{% url 'staff_roles' %}">Роли</a>
  </div>
  <a class="btn" href="{% url 'staff_user_add' %}">➕ Добавить пользователя</a>
</div>

<h1>Персонал</h1>

<table class="list-table">
  <thead>
    <tr>
      <th>Логин</th>
      <th>Имя</th>
      <th>Email</th>
      <th>Роль</th>
      <th>Статус</th>
      <th style="width:260px;">Действия</th>
    </tr>
  </thead>
  <tbody>
    {% for row in items %}
      <tr>
        <td>{{ row.user.username }}</td>
        <td>{{ row.user.first_name }} {{ row.user.last_name }}</td>
        <td>{{ row.user.email }}</td>
        <td>{{ row.role }}</td>
        <td>
          {% if row.user.is_active %}
            <span class="badge badge-ok">активен</span>
          {% else %}
            <span class="badge badge-muted">выключен</span>
          {% endif %}
          {% if row.user.is_superuser %}
            <span class="badge badge-warn">superuser</span>
          {% endif %}
        </td>
        <td>
          <a class="btn-secondary" href="{% url 'staff_user_edit' row.user.id %}">Редактировать</a>
          {% if not row.user.is_superuser %}
            <a class="btn-secondary" href="{% url 'staff_user_delete' row.user.id %}">Удалить</a>
          {% endif %}
        </td>
      </tr>
    {% empty %}
      <tr><td colspan="6">Пользователей нет</td></tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}
