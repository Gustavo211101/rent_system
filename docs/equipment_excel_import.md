# Импорт оборудования из Excel

## Назначение

Документ описывает формат Excel-файла и правила импорта оборудования
в систему при проведении инвентаризации.

Импорт используется только для загрузки оборудования,
которое физически находится **на складе** или **в ремонте**.

---

## Общий принцип

- Одна строка Excel = одна физическая единица оборудования
- Импорт **добавляет данные поверх существующих**
- Импорт не удаляет и не изменяет существующие единицы

---

## Формат Excel-файла

Рекомендуется один лист.

### Обязательные колонки

1. **Категория**
2. **Подкатегория** (может быть пусто)
3. **Наименование** — тип оборудования
4. **Инвентарный номер**

### Необязательные колонки

5. **Статус**
6. **Комментарий**
7. **Вес (кг)**
8. **Ширина (мм)**
9. **Высота (мм)**
10. **Глубина (мм)**
11. **Энергопотребление (Вт)**

---

## Правила обработки данных

### Категории и подкатегории
- если категории нет — создаётся
- если подкатегории нет — создаётся
- подкатегория может быть пустой

---

### Тип оборудования

Тип определяется связкой:
**Категория + Подкатегория + Наименование**

- если тип отсутствует — создаётся
- если тип существует — используется

#### Характеристики типа
Если в Excel указаны:
- вес
- габариты
- энергопотребление

То они **перезаписывают** характеристики типа
(перезаписываются только непустые значения).

---

### Инвентарный номер

- инвентарный номер должен быть уникален
- если инвентарник уже существует:
  - строка пропускается
  - импорт продолжается
  - информация добавляется в отчёт

---

### Статусы

Допустимые значения:
- **На складе**
- **В ремонте**

Правила:
- если статус пустой → считается «На складе»
- статус «На мероприятии» **недопустим**
- неизвестный статус → строка пропускается

---

### Комментарий

- сохраняется в единице оборудования
- может использоваться для описания дефектов или комплектности

---

## Отчёт по результатам импорта

После завершения импорта пользователю показывается отчёт:

- количество успешно добавленных единиц
- количество пропущенных строк
- таблица ошибок:
  - номер строки Excel
  - инвентарный номер
  - причина пропуска

---

## Что импорт НЕ делает

- не создаёт привязку к мероприятиям
- не переводит оборудование в статус «На мероприятии»
- не удаляет существующие данные
- не обновляет существующие единицы оборудования

---

## Принцип безопасности

Импорт не должен:
- ломать существующие данные
- изменять состояние склада без явного указания
