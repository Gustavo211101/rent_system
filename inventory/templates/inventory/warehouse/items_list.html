{% extends "base.html" %}
{% load static %}
{% load inventory_extras %}
{% block content %}
<div class="container" style="max-width:1100px; margin:0 auto; padding:20px;">
  <h2 style="margin:0 0 8px 0;">{{ eq_type.name }}</h2>
  <div style="margin:0 0 16px 0; color:#6b7280;">
    Категория: {{ eq_type.category.name|default:"—" }} · Подкатегория: {{ eq_type.subcategory.name|default:"—" }}
  </div>

  <div style="display:flex; gap:10px; align-items:center; margin-bottom:16px;">
    <a class="btn" href="{% url 'stock_type_list' %}">← Назад к типам</a>
    {% if can_manage %}
      <a class="btn" href="{% url 'stock_item_add' type_id=eq_type.id %}">+ Добавить единицу</a>
    {% endif %}
  </div>

  <table class="table" style="width:100%; border-collapse:collapse;">
    <thead>
      <tr style="text-align:left; border-bottom:1px solid #e5e7eb;">
        <th style="padding:10px;">Инвентарник</th>
        <th style="padding:10px;">Статус</th>
        <th style="padding:10px;">Комментарий</th>
        <th style="padding:10px; width:260px;">Действия</th>
      </tr>
    </thead>
    <tbody>
      {% for item in items %}
      <tr style="border-bottom:1px solid #f3f4f6;">
        <td style="padding:10px; font-weight:600;">{{ item.inventory_number }}</td>
        <td style="padding:10px;">{{ item.get_status_display }}</td>
        <td style="padding:10px;">{{ item.comment|dash_if_empty }}</td>
        <td style="padding:10px; display:flex; gap:8px; flex-wrap:wrap;">
          <a class="btn" href="{% url 'stock_item_card' type_id=eq_type.id item_id=item.id %}">Открыть карточку</a>
          <a class="btn" href="{% url 'stock_item_qr' type_id=eq_type.id item_id=item.id %}">Показать QR</a>
          {% if can_manage %}
            <a class="btn" href="{% url 'stock_item_edit' type_id=eq_type.id item_id=item.id %}">Редактировать</a>
            <form method="post" action="{% url 'stock_item_delete' type_id=eq_type.id item_id=item.id %}" style="margin:0;">
              {% csrf_token %}
              <button class="btn" type="submit" onclick="return confirm('Удалить единицу?')">Удалить</button>
            </form>
          {% endif %}
        </td>
      </tr>
      {% empty %}
      <tr><td colspan="4" style="padding:14px; color:#6b7280;">Единицы ещё не заведены.</td></tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}