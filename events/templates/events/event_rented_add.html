{% extends "base.html" %}

{% block content %}
<h1>Взято в аренду</h1>
<p><strong>Мероприятие:</strong> <a href="{% url 'event_detail' event.id %}">{{ event.name }}</a></p>

{% if shortages %}
    <div style="padding:12px; border:1px solid #f59e0b; background:#fffbeb; border-radius:12px; margin-bottom:16px;">
        <strong>⚠️ Нехватка, которую можно покрыть арендой:</strong>
        <ul style="margin:8px 0 0 18px;">
            {% for s in shortages %}
                <li>
                    {{ s.equipment.name }} — не хватает {{ s.shortage }}
                </li>
            {% endfor %}
        </ul>
    </div>
{% else %}
    <div style="padding:12px; border:1px solid #10b981; background:#ecfdf5; border-radius:12px; margin-bottom:16px;">
        <strong>✅ Нехватки нет.</strong>
    </div>
{% endif %}

<form method="post">
    {% csrf_token %}
    {{ form.as_p }}
    <button type="submit" class="btn">Добавить аренду</button>
    <a class="btn-secondary" href="{% url 'event_detail' event.id %}">Назад</a>
</form>

<hr>

<h2>Уже добавлено (аренда)</h2>

{% if rented_items %}
    <table class="list-table">
        <thead>
            <tr>
                <th>Позиция</th>
                <th style="width:120px;">Кол-во</th>
                <th style="width:140px;">Действия</th>
            </tr>
        </thead>
        <tbody>
            {% for item in rented_items %}
            <tr>
                <td>{{ item.equipment.name }}</td>
                <td>{{ item.quantity }}</td>
                <td>
                    <form method="post" action="{% url 'event_rented_delete' event.id item.id %}">
                        {% csrf_token %}
                        <button type="submit" class="btn-secondary">Удалить</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
{% else %}
    <p>Пока ничего не арендовано.</p>
{% endif %}

{% endblock %}
